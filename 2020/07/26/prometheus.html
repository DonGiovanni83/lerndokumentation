<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Playing with Prometheus | </title> <meta name="description" content=""> <meta itemprop="name" content=""> <meta itemprop="description" content=""> <meta itemprop="image" content="/lerndokumentation/assets/images/prometheus.png"> <meta property="og:url" content="/lerndokumentation/2020/07/26/prometheus.html"> <meta property="og:type" content="website"> <meta property="og:title" content="Playing with Prometheus | "> <meta property="og:site_name" content=""> <meta property="og:description" content=""> <meta property="og:image" content="https://dongiovanni83.github.io/lerndokumentation/assets/images/prometheus.png"> <meta name="twitter:url" content="https://dongiovanni83.github.io/lerndokumentation/2020/07/26/prometheus.html"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Playing with Prometheus | "> <meta name="twitter:site" content=""> <meta name="twitter:description" content=""> <meta property="twitter:image" content="https://dongiovanni83.github.io/lerndokumentation/assets/images/prometheus.png"> <link rel="icon" type="image/x-icon" href="/lerndokumentation/assets/images/favicon.ico"> <link rel="stylesheet" href="/lerndokumentation/assets/css/app.min.css"> <link rel="alternate" type="application/rss+xml" title="" href="/lerndokumentation/feed.xml"> <link rel="canonical" href="/lerndokumentation/2020/07/26/prometheus.html"> </head> <body id="playing-with-prometheus" class="post-layout"> <header class="header"> <a class="header__title" href="https://dongiovanni83.github.io/lerndokumentation/"></a> <nav> <ul class="header__list"> <li><a href="/lerndokumentation/">Home</a></li> <li><a href="https://www.puzzle.ch/de/blog/articles/author/fbertagna">√úber mich</a></li> </ul> </nav> </header> <main class="üíà"> <div class="post"> <article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"> <div class="post__header section-padding--double"> <div class="grid-small"> <h2 itemprop="name headline">Playing with Prometheus</h2> <time class="post__date" datetime="2020-07-26T00:00:00+00:00" itemprop="datePublished">26 Jul 2020</time> </div> </div> <div class="post__img"> <div> <figure class="absolute-bg" style="background-image: url('/assets/images/prometheus.png');"></figure> </div> </div> <div class="post__content section-padding"> <div class="grid"> <div id="markdown" itemprop="articleBody"> <p>Nach der Theorie zu Prometheus und Grafana in den <a href="/2020/07/24/sys-labs">/sys-labs</a> habe ich diese beiden Technologien in einem ganz einfachen Docker-Setup zusammen gespannt, um diese mal in der Praxis auszuprobieren und damit rum zu spielen.</p> <p>In einem Container soll eine Prometheus Server Instanz laufen, welche metrics von einem weiteren Container holen soll. Dieser Container ist ein Linux System mit dem Node Exporeter drauf welcher Prometheus daten zur verf√ºgung stellt. Grafana soll in einem dritten Container laufen, wo dann der Prometheus Container als Data Source registriert werden soll, und in einem Dashboard die Daten visualisiert werden sollen.</p> <p>Im <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file sieht das Ganze wie folgt aus.</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/prometheus:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">prometheus</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./config:/etc/prometheus/</span>
      <span class="pi">-</span> <span class="s">./data:/prometheus</span>
    <span class="na">command</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">--config.file=/etc/prometheus/prometheus.yml'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">--storage.tsdb.path=/home/prometheus'</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9090</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9090:9090</span>
    <span class="na">links</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">target:target</span>


  <span class="na">target</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">target</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/node-exporter:latest</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9100</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9100:9100</span>

  <span class="na">grafana</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">grafana</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">grafana/grafana:latest</span>
    <span class="na">links</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">prometheus:prometheus</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./data/grafana:/var/lib/grafana</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s2">"</span><span class="s">root"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">3000:3000</span>

</code></pre></div></div> <p>Mit diesem Setup hatte ich die M√∂glichkeit verschiedenes auszuprobieren und lernen, wie z.B. das registrieren einer Data Source bei Grafana, das Erstellen oder Importieren eines Dashboards auch in Grafana oder auch Queries √ºber den Prometheus Server auf die Targets abzusetzen.</p> <p><img src="/assets/images/grafana-dashboard.png" alt="Grafana Dashboard" /></p> <p>Bei diesem kleinen Experiment war nicht nur spannend zu sehen wie Prometheus und Grafana zusammen funktionieren, sondern auch das Konfigurieren der Docker-Container. Dabei war es wichtig die Container √ºber die ben√∂tigten Ports erreichbar f√ºr die Anderen zu machen, damit jeder Container seine ben√∂tigten Informationen beim jeweiligen Container abholen kann.</p> </div> <ul class="post__social"> </ul> </div> </div> <!-- Everything inside the #author tags pulls data from the author --> <div class="section-padding--none"> <div class="grid"> <hr class="sep"/> </div> </div> <div class="section-padding"> <div class="grid-small"> <span class="post__author">Posted by Fabio Bertagna</span> <p class="post__bio"></p> </div> </div> <!-- If you use Disqus comments, just uncomment this block. The only thing you need to change is "test-apkdzgmqhj" - which should be replaced with your own Disqus site-id. <div class="post__comments section-padding"> <div class="grid-small"> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = 'https://dongiovanni83.github.io/lerndokumentation/2020/07/26/prometheus.html'; this.page.identifier = 'https://dongiovanni83.github.io/lerndokumentation/2020/07/26/prometheus.html'; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', + new Date()); (d.head || d.body).appendChild(s); })(); </script> </div> </div> --> </article> </div> <!-- Links to Previous/Next posts --> <section class="related section-padding"> <div class="grid-xlarge"> <h2 class="related__title">Related</h2> <div class="related__container"> <article class="related__post"> <a class="related__link" href="https://dongiovanni83.github.io/lerndokumentation/2020/07/26/prometheus.html"> <figure class="related__img"> <img src="/assets/images/prometheus.png" alt="Playing with Prometheus"/> </figure> <div> <h2 class="related__text">Playing with Prometheus</h2> </div> </a> </article> </div> </div> </section> </main> <!-- The footer at the very bottom of the screen --> <footer class="footer section-padding"> <div class="grid"> <hr class="sep--white"/> <div class="footer__container"> <ul class="footer__tags"><li><a class="footer__link" href="/tag/linux">Linux</a></li><li><a class="footer__link" href="/tag/ansible">Ansible</a></li><li><a class="footer__link" href="/tag/ubuntu">Ubuntu</a></li><li><a class="footer__link" href="/tag/prometheus">Prometheus</a></li></ul> </div> </div> </footer> <section class="contact popup"> <div class="popup__close"> <div class="popup__exit"></div> </div> <div class="contact__container popup__container"> <div class="contact__img"> <figure class="absolute-bg" style="background-image: url(/lerndokumentation);"></figure> </div> <div class="contact__content"> <div class="contact__mast section-padding--half"> <div class="grid"> <h2>Contact</h2> </div> </div> <div class="section-padding--none"> <hr class="sep"/> </div> <div class="contact__form section-padding--half"> <div class="grid-xlarge"> <form id="form" class="form" action="" method="POST"> <div class="form__subcontainer"> <div> <label for="form-first-name">First Name</label> <input type="text" name="first-name" id="form-first-name" required> </div> <div> <label for="form-last-name">Last Name</label> <input type="text" name="last-name" id="form-last-name" required> </div> </div> <div> <label for="form-email">E-Mail</label> <input type="email" name="email" id="form-email" required> </div> <div> <label for="form-message">Message</label> <textarea name="message" id="form-message" rows="3"></textarea> </div> <div class="form__submit"> <div class="form__btn"> <input type="submit" value="Send"> </div> </div> <p class="form__message"></p> </form> </div> </div> </div> </div> </section> <script src="/lerndokumentation/assets/js/app.min.js"></script> </body> </html>
  