<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Playing with Prometheus | Way-Up 2020-2022</title><meta name="description" content="Dokunentation meiner Ausbildung bei Puzzle ITC zum Systemtechniker EFZ."><meta itemprop="name" content="Fabio Bertagna"><meta itemprop="description" content="Dokunentation meiner Ausbildung bei Puzzle ITC zum Systemtechniker EFZ."><meta itemprop="image" content="/lerndokumentation/assets/images/prometheus.png"><meta property="og:url" content="/lerndokumentation/2020/07/26/prometheus/"><meta property="og:type" content="website"><meta property="og:title" content="Playing with Prometheus | Way-Up 2020-2022"><meta property="og:site_name" content="Way-Up 2020-2022"><meta property="og:description" content="Dokunentation meiner Ausbildung bei Puzzle ITC zum Systemtechniker EFZ."><meta property="og:image" content="/lerndokumentation/assets/images/prometheus.png"><link rel="icon" type="image/x-icon" href="/lerndokumentation/assets/images/favicon.ico"><link rel="stylesheet" href="/lerndokumentation/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="Way-Up 2020-2022" href="/lerndokumentation/feed.xml"><link rel="canonical" href="/lerndokumentation/2020/07/26/prometheus/"></head><body id="playing-with-prometheus" class="post-layout"><header class="header"> <a class="header__title" href="/lerndokumentation/">Way-Up 2020-2022</a><nav><ul class="header__list"><li><a href="/lerndokumentation/">Home</a></li><li><a href="https://www.puzzle.ch/de/blog/articles/author/fbertagna">√úber mich</a></li></ul></nav></header><main class="üíà"><div class="post"><article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding--double"><div class="grid-small"><h2 itemprop="name headline">Playing with Prometheus</h2><time class="post__date" datetime="2020-07-26T00:00:00+00:00" itemprop="datePublished">26 Jul 2020</time></div></div><div class="post__img"><div><figure class="absolute-bg" style="background-image: url('/lerndokumentation/assets/images/prometheus.png');"></figure></div></div><div class="post__content section-padding"><div class="grid"><div id="markdown" itemprop="articleBody"><p>Nach der Theorie zu Prometheus und Grafana in den <a href="/2020/07/24/sys-labs">/sys-labs</a> habe ich diese beiden Technologien in einem ganz einfachen Docker-Setup zusammen gespannt, um diese mal in der Praxis auszuprobieren und damit rum zu spielen.</p><p>In einem Container soll eine Prometheus Server Instanz laufen, welche metrics von einem weiteren Container holen soll. Dieser Container ist ein Linux System mit dem Node Exporeter drauf welcher Prometheus daten zur verf√ºgung stellt. Grafana soll in einem dritten Container laufen, wo dann der Prometheus Container als Data Source registriert werden soll, und in einem Dashboard die Daten visualisiert werden sollen.</p><p>Im <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file sieht das Ganze wie folgt aus.</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">prometheus</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/prometheus:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">prometheus</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./config:/etc/prometheus/</span>
      <span class="pi">-</span> <span class="s">./data:/prometheus</span>
    <span class="na">command</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">--config.file=/etc/prometheus/prometheus.yml'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">--storage.tsdb.path=/home/prometheus'</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9090</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9090:9090</span>
    <span class="na">links</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">target:target</span>


  <span class="na">target</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">target</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">prom/node-exporter:latest</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9100</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">9100:9100</span>

  <span class="na">grafana</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">grafana</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">grafana/grafana:latest</span>
    <span class="na">links</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">prometheus:prometheus</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./data/grafana:/var/lib/grafana</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s2">"</span><span class="s">root"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">3000:3000</span>

</code></pre></div></div><p>Mit diesem Setup hatte ich die M√∂glichkeit verschiedenes auszuprobieren und lernen, wie z.B. das registrieren einer Data Source bei Grafana, das Erstellen oder Importieren eines Dashboards auch in Grafana oder auch Queries √ºber den Prometheus Server auf die Targets abzusetzen.</p><p><img src="/assets/images/grafana-dashboard.png" alt="Grafana Dashboard" /></p><p>Bei diesem kleinen Experiment war nicht nur spannend zu sehen wie Prometheus und Grafana zusammen funktionieren, sondern auch das Konfigurieren der Docker-Container. Dabei war es wichtig die Container √ºber die ben√∂tigten Ports erreichbar f√ºr die Anderen zu machen, damit jeder Container seine ben√∂tigten Informationen beim jeweiligen Container abholen kann.</p></div></div></div><div class="section-padding--none"><div class="grid"><hr class="sep"/></div></div><div class="section-padding"><div class="grid-small"> <span class="post__author">Posted by <a href="https://www.puzzle.ch/de/blog/articles/author/fbertagna" title="More By Fabio Bertagna">Fabio Bertagna</a></span><p class="post__bio"></p></div></div></article></div><section class="related section-padding"><div class="grid-xlarge"><h2 class="related__title">Related</h2><div class="related__container"><article class="related__post"> <a class="related__link" href="/lerndokumentation/2020/07/26/prometheus/"><figure class="related__img"> <img src="/lerndokumentation/assets/images/prometheus.png" alt="Playing with Prometheus"/></figure><div><h2 class="related__text">Playing with Prometheus</h2></div></a></article></div></div></section></main><footer class="footer section-padding"><div class="grid"><hr class="sep--white"/><div class="footer__container"><ul class="footer__tags"><li><a class="footer__link" href="/tag/linux">Linux</a></li><li><a class="footer__link" href="/tag/ansible">Ansible</a></li><li><a class="footer__link" href="/tag/ubuntu">Ubuntu</a></li><li><a class="footer__link" href="/tag/prometheus">Prometheus</a></li></ul></div></div></footer><script src="/lerndokumentation/assets/js/app.min.js"></script></body></html>
  